(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4011],{3827:function(e,r,o){Promise.resolve().then(o.bind(o,8913))},8913:function(e,r,o){"use strict";o.r(r),o.d(r,{default:function(){return b}});var a=o(9807),t=o(8249),s=o(259),n=o(7694),l=o(8355),i=o(9102),u=o(7459),d=o(2611),c=o(6830),f=o(5200),m=o(6976),p=o(4616);function b(){let e=(0,s.useRouter)(),{createUserDocument:r,cleanupUserOnError:o,loading:b,role:h}=(0,p.a)(),[g,v]=(0,n.useState)(!1),[x,y]=(0,n.useState)({name:"",email:"",password:"",confirmPassword:"",promoCode:""}),w=e=>{let{name:r,value:o}=e.target;y(e=>({...e,[r]:o}))},N=async a=>{if(a.preventDefault(),x.password!==x.confirmPassword){c.A.error("As senhas n\xe3o coincidem");return}if(!m.I8){c.A.error("Erro ao inicializar o Firebase");return}v(!0);let t=null;try{console.log("Iniciando cria\xe7\xe3o do usu\xe1rio no Firebase Auth"),t=await (0,f.Xb)(m.I8,x.email,x.password),console.log("Usu\xe1rio criado no Firebase Auth:",t.user.uid),await (0,f.ck)(t.user,{displayName:x.name}),console.log("DisplayName atualizado:",x.name),console.log("Criando documento do usu\xe1rio");let o=await r(t.user,x.name,x.promoCode);if(console.log("Documento do usu\xe1rio criado:",o),!o)throw Error("N\xe3o foi poss\xedvel criar o perfil do usu\xe1rio");c.A.success("Cadastro realizado com sucesso!",{duration:4e3,position:"top-center"});let a="professor"===o.role?"/professor/dashboard":"/dashboard";console.log("Redirecionando para:",a,"baseado na role:",o.role),e.push(a)}catch(r){if(console.error("Erro durante o cadastro:",r),null==t?void 0:t.user)try{console.log("Limpando dados do usu\xe1rio devido ao erro"),await o(t.user)}catch(e){console.error("Erro ao limpar dados do usu\xe1rio:",e)}let e="Ocorreu um erro ao realizar o cadastro";switch(r.code){case"auth/email-already-in-use":e="Este email j\xe1 est\xe1 em uso";break;case"auth/invalid-email":e="Email inv\xe1lido";break;case"auth/weak-password":e="A senha deve ter pelo menos 6 caracteres";break;case"auth/network-request-failed":e="Erro de conex\xe3o. Verifique sua internet e tente novamente";break;default:r.message&&(e=r.message),console.error("Erro n\xe3o tratado:",r)}c.A.error(e,{duration:5e3,position:"top-center"})}finally{v(!1)}};return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-blue-50 p-4",children:(0,a.jsxs)(i.Zb,{className:"w-full max-w-md border-blue-200",children:[(0,a.jsxs)(i.Ol,{className:"space-y-1 bg-blue-50 rounded-t-lg",children:[(0,a.jsx)(i.ll,{className:"text-2xl font-bold text-center text-blue-900",children:"Cadastro"}),(0,a.jsx)(i.SZ,{className:"text-center text-blue-700",children:"Crie sua conta na plataforma Mestre da Reda\xe7\xe3o"})]}),(0,a.jsxs)("form",{onSubmit:N,children:[(0,a.jsxs)(i.aY,{className:"space-y-4 pt-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"name",className:"text-blue-800",children:"Nome"}),(0,a.jsx)(u.I,{id:"name",name:"name",type:"text",placeholder:"Digite seu nome",value:x.name,onChange:w,required:!0,className:"border-blue-200 focus:border-blue-400"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"email",className:"text-blue-800",children:"Email"}),(0,a.jsx)(u.I,{id:"email",name:"email",type:"email",placeholder:"Digite seu email",value:x.email,onChange:w,required:!0,className:"border-blue-200 focus:border-blue-400"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"password",className:"text-blue-800",children:"Senha"}),(0,a.jsx)(u.I,{id:"password",name:"password",type:"password",placeholder:"Digite sua senha",value:x.password,onChange:w,required:!0,className:"border-blue-200 focus:border-blue-400"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"confirmPassword",className:"text-blue-800",children:"Confirmar Senha"}),(0,a.jsx)(u.I,{id:"confirmPassword",name:"confirmPassword",type:"password",placeholder:"Confirme sua senha",value:x.confirmPassword,onChange:w,required:!0,className:"border-blue-200 focus:border-blue-400"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"promoCode",className:"text-blue-800",children:"C\xf3digo Promocional (opcional)"}),(0,a.jsx)(u.I,{id:"promoCode",name:"promoCode",type:"text",placeholder:"Digite seu c\xf3digo promocional",value:x.promoCode,onChange:w,className:"border-blue-200 focus:border-blue-400"})]})]}),(0,a.jsxs)(i.eW,{className:"flex flex-col space-y-4",children:[(0,a.jsx)(l.z,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700",disabled:g,children:g?"Cadastrando...":"Cadastrar"}),(0,a.jsxs)("div",{className:"text-center text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"J\xe1 tem uma conta? "}),(0,a.jsx)(t.default,{href:"/login",className:"text-blue-600 hover:underline",children:"Fa\xe7a login"})]})]})]})]})})}},8355:function(e,r,o){"use strict";o.d(r,{d:function(){return i},z:function(){return u}});var a=o(9807),t=o(7694),s=o(2931),n=o(6640),l=o(9456);let i=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",terciary:"bg-background border border-primary text-primary hover:bg-primary/10"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=t.forwardRef((e,r)=>{let{className:o,variant:t,size:n,asChild:u=!1,...d}=e,c=u?s.g7:"button";return(0,a.jsx)(c,{className:(0,l.cn)(i({variant:t,size:n,className:o})),ref:r,...d})});u.displayName="Button"},9102:function(e,r,o){"use strict";o.d(r,{Ol:function(){return l},SZ:function(){return u},Zb:function(){return n},aY:function(){return d},eW:function(){return c},ll:function(){return i}});var a=o(9807),t=o(7694),s=o(9456);let n=t.forwardRef((e,r)=>{let{className:o,...t}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",o),...t})});n.displayName="Card";let l=t.forwardRef((e,r)=>{let{className:o,...t}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",o),...t})});l.displayName="CardHeader";let i=t.forwardRef((e,r)=>{let{className:o,...t}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",o),...t})});i.displayName="CardTitle";let u=t.forwardRef((e,r)=>{let{className:o,...t}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",o),...t})});u.displayName="CardDescription";let d=t.forwardRef((e,r)=>{let{className:o,...t}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",o),...t})});d.displayName="CardContent";let c=t.forwardRef((e,r)=>{let{className:o,...t}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",o),...t})});c.displayName="CardFooter"},7459:function(e,r,o){"use strict";o.d(r,{I:function(){return n}});var a=o(9807),t=o(7694),s=o(9456);let n=t.forwardRef((e,r)=>{let{className:o,type:t,...n}=e;return(0,a.jsx)("input",{type:t,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",o),ref:r,...n})});n.displayName="Input"},2611:function(e,r,o){"use strict";o.d(r,{_:function(){return u}});var a=o(9807),t=o(7694),s=o(8519),n=o(6640),l=o(9456);let i=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=t.forwardRef((e,r)=>{let{className:o,...t}=e;return(0,a.jsx)(s.f,{ref:r,className:(0,l.cn)(i(),o),...t})});u.displayName=s.f.displayName},4616:function(e,r,o){"use strict";o.d(r,{AuthProvider:function(){return u},a:function(){return d}});var a=o(9807),t=o(7694),s=o(2936),n=o(6976),l=o(5200);let i=(0,t.createContext)(null);function u(e){let{children:r}=e,[o,u]=(0,t.useState)(null),[d,c]=(0,t.useState)(null),[f,m]=(0,t.useState)(!0),[p,b]=(0,t.useState)(null),h=async e=>{try{let r=(0,s.JU)(n.db,"users",e.uid);await (0,s.oe)(r),console.log("Documento do usu\xe1rio deletado com sucesso"),await (0,l.h8)(e),console.log("Usu\xe1rio deletado do Auth com sucesso"),u(null),c(null),b(null)}catch(e){throw console.error("Erro ao limpar usu\xe1rio:",e),e}},g=async(e,r,o)=>{try{console.log("Iniciando cria\xe7\xe3o do documento do usu\xe1rio:",e.uid);let a=(0,s.JU)(n.db,"users",e.uid);if(!(await (0,s.QT)(a)).exists()){console.log("Criando novo documento para o usu\xe1rio");let t={id:e.uid,name:r,email:e.email||"",role:"student",createdAt:(0,s.Bt)(),lastLogin:(0,s.Bt)()};return console.log("Dados do novo usu\xe1rio:",t),await (0,s.pl)(a,t,{merge:!1}),console.log("Documento criado com sucesso"),await (0,s.ET)((0,s.hJ)(n.db,"subscriptions"),{userId:e.uid,type:"MESTRE_AMIGO"===o?"private":"free",status:"active",createdAt:(0,s.Bt)(),updatedAt:(0,s.Bt)(),tokens:{available:0,unlimited:"MESTRE_AMIGO"===o}}),console.log("Assinatura criada com sucesso"),b("student"),c(r),t}return null}catch(e){throw console.error("Erro ao criar documento do usu\xe1rio:",e),e}},v=async e=>{try{let r=await (0,s.QT)((0,s.JU)(n.db,"users",e));if(r.exists()){let e=r.data();return c(e.name),b(e.role),e}return null}catch(e){return console.error("Erro ao buscar dados do usu\xe1rio:",e),null}};return(0,t.useEffect)(()=>{let e=n.I8.onAuthStateChanged(async e=>{console.log("Auth state changed, user:",null==e?void 0:e.uid),u(e),m(!0);try{e?await v(e.uid)||(c(null),b(null)):(c(null),b(null),console.log("User logged out, role set to null"))}catch(e){console.error("Erro ao carregar dados do usu\xe1rio:",e),b(null),c(null)}finally{m(!1)}});return()=>e()},[]),(0,a.jsx)(i.Provider,{value:{user:o,userName:d,loading:f,role:p,createUserDocument:g,cleanupUserOnError:h,fetchUserData:v,updateLastLogin:e=>{let r=(0,s.JU)(n.db,"users",e);(0,s.pl)(r,{lastLogin:(0,s.Bt)()},{merge:!0}).catch(e=>{console.error("Erro ao atualizar lastLogin:",e)})}},children:r})}function d(){let e=(0,t.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},6976:function(e,r,o){"use strict";let a,t,s;o.d(r,{I8:function(){return a},db:function(){return t},tO:function(){return s}});var n=o(3631),l=o(3797),i=o(5200),u=o(2936),d=o(9542);let c={apiKey:"AIzaSyABZJxTb4i_SDIBE-j530FN1cGBwmkB054",authDomain:"mestre-da-redacao.firebaseapp.com",projectId:"mestre-da-redacao",storageBucket:"mestre-da-redacao.firebasestorage.app",messagingSenderId:"326080016742",appId:"1:326080016742:web:239aa8c38ec32dcfe018a7"};console.log("Configura\xe7\xe3o do Firebase:",{...c,apiKey:"***"});let f=(0,n.ZF)(c),m=null;try{console.log("App Firebase inicializado:",f.name),m=(0,l.IH)(f),a=(0,i.v0)(f),t=(0,u.ad)(f),s=(0,d.getStorage)(f),console.log("Servi\xe7os Firebase inicializados:",{auth:!!a,db:!!t,analytics:!!m,storage:!!s})}catch(e){throw console.error("Erro ao inicializar Firebase:",e),e}},9456:function(e,r,o){"use strict";o.d(r,{cn:function(){return s}});var a=o(8223),t=o(6257);function s(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return(0,t.m6)((0,a.W)(r))}},8249:function(e,r,o){"use strict";o.d(r,{default:function(){return t.a}});var a=o(8837),t=o.n(a)},259:function(e,r,o){"use strict";var a=o(2779);o.o(a,"useRouter")&&o.d(r,{useRouter:function(){return a.useRouter}}),o.o(a,"useSearchParams")&&o.d(r,{useSearchParams:function(){return a.useSearchParams}})},8519:function(e,r,o){"use strict";o.d(r,{f:function(){return l}});var a=o(7694),t=o(8892),s=o(9807),n=a.forwardRef((e,r)=>(0,s.jsx)(t.WV.label,{...e,ref:r,onMouseDown:r=>{var o;r.target.closest("button, input, select, textarea")||(null===(o=e.onMouseDown)||void 0===o||o.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));n.displayName="Label";var l=n},8892:function(e,r,o){"use strict";o.d(r,{WV:function(){return l},jH:function(){return i}});var a=o(7694),t=o(2723),s=o(2931),n=o(9807),l=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,r)=>{let o=a.forwardRef((e,o)=>{let{asChild:a,...t}=e,l=a?s.g7:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,n.jsx)(l,{...t,ref:o})});return o.displayName=`Primitive.${r}`,{...e,[r]:o}},{});function i(e,r){e&&t.flushSync(()=>e.dispatchEvent(r))}},6640:function(e,r,o){"use strict";o.d(r,{j:function(){return n}});var a=o(8223);let t=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=a.W,n=(e,r)=>o=>{var a;if((null==r?void 0:r.variants)==null)return s(e,null==o?void 0:o.class,null==o?void 0:o.className);let{variants:n,defaultVariants:l}=r,i=Object.keys(n).map(e=>{let r=null==o?void 0:o[e],a=null==l?void 0:l[e];if(null===r)return null;let s=t(r)||t(a);return n[e][s]}),u=o&&Object.entries(o).reduce((e,r)=>{let[o,a]=r;return void 0===a||(e[o]=a),e},{});return s(e,i,null==r?void 0:null===(a=r.compoundVariants)||void 0===a?void 0:a.reduce((e,r)=>{let{class:o,className:a,...t}=r;return Object.entries(t).every(e=>{let[r,o]=e;return Array.isArray(o)?o.includes({...l,...u}[r]):({...l,...u})[r]===o})?[...e,o,a]:e},[]),null==o?void 0:o.class,null==o?void 0:o.className)}}},function(e){e.O(0,[5453,291,3727,5624,8837,6830,4315,514,1744],function(){return e(e.s=3827)}),_N_E=e.O()}]);