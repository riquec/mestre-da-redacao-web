(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2626],{2938:function(e,r,t){Promise.resolve().then(t.bind(t,5886))},5886:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return p}});var a=t(9807),o=t(8249),n=t(259),s=t(7694),l=t(8355),i=t(9102),u=t(7459),d=t(2611),c=t(6830),f=t(5200),m=t(6976),b=t(4616);function p(){let e=(0,n.useRouter)(),{loading:r,role:t,fetchUserData:p,updateLastLogin:g}=(0,b.a)(),[h,v]=(0,s.useState)(!1),[x,y]=(0,s.useState)({email:"",password:""});(0,s.useEffect)(()=>{console.log("Auth state changed:",{role:t,loading:r})},[t,r]);let w=e=>{let{name:r,value:t}=e.target;y(e=>({...e,[r]:t}))},N=async r=>{if(r.preventDefault(),!m.I8){c.A.error("Erro ao inicializar o Firebase");return}v(!0);try{let r=await (0,f.e5)(m.I8,x.email,x.password),t=await p(r.user.uid);if(!t)throw Error("N\xe3o foi poss\xedvel carregar o perfil do usu\xe1rio");g(r.user.uid),c.A.success("Login realizado com sucesso!",{duration:4e3,position:"top-center"});let a="professor"===t.role?"/professor/dashboard":"/dashboard";console.log("Redirecionando para:",a,"baseado na role:",t.role),e.push(a)}catch(r){console.error("Erro durante o login:",r);let e="Ocorreu um erro ao fazer login";switch(r.code){case"auth/invalid-email":e="Email inv\xe1lido";break;case"auth/user-disabled":e="Esta conta foi desativada";break;case"auth/user-not-found":e="Usu\xe1rio n\xe3o encontrado";break;case"auth/wrong-password":e="Senha incorreta";break;case"auth/network-request-failed":e="Erro de conex\xe3o. Verifique sua internet e tente novamente";break;case"auth/too-many-requests":e="Muitas tentativas. Tente novamente mais tarde";break;default:r.message&&(e=r.message),console.error("Erro n\xe3o tratado:",r)}c.A.error(e,{duration:5e3,position:"top-center"})}finally{v(!1)}};return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-blue-50 p-4",children:(0,a.jsxs)(i.Zb,{className:"w-full max-w-md border-blue-200",children:[(0,a.jsxs)(i.Ol,{className:"space-y-1 bg-blue-50 rounded-t-lg",children:[(0,a.jsx)(i.ll,{className:"text-2xl font-bold text-center text-blue-900",children:"Entrar"}),(0,a.jsx)(i.SZ,{className:"text-center text-blue-700",children:"Acesse sua conta na plataforma Mestre da Reda\xe7\xe3o"})]}),(0,a.jsxs)("form",{onSubmit:N,children:[(0,a.jsxs)(i.aY,{className:"space-y-4 pt-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"email",className:"text-blue-800",children:"Email"}),(0,a.jsx)(u.I,{id:"email",name:"email",type:"email",placeholder:"Digite seu email",value:x.email,onChange:w,required:!0,className:"border-blue-200 focus:border-blue-400"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"password",className:"text-blue-800",children:"Senha"}),(0,a.jsx)(u.I,{id:"password",name:"password",type:"password",placeholder:"Digite sua senha",value:x.password,onChange:w,required:!0,className:"border-blue-200 focus:border-blue-400"})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsx)(o.default,{href:"/forgot-password",className:"text-sm text-blue-600 hover:underline",children:"Esqueceu a senha?"})})]}),(0,a.jsxs)(i.eW,{className:"flex flex-col space-y-4",children:[(0,a.jsx)(l.z,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700",disabled:h,children:h?"Entrando...":"Entrar"}),(0,a.jsxs)("div",{className:"text-center text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"N\xe3o tem uma conta? "}),(0,a.jsx)(o.default,{href:"/register",className:"text-blue-600 hover:underline",children:"Cadastre-se"})]})]})]})]})})}},8355:function(e,r,t){"use strict";t.d(r,{d:function(){return i},z:function(){return u}});var a=t(9807),o=t(7694),n=t(2931),s=t(6640),l=t(9456);let i=(0,s.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",terciary:"bg-background border border-primary text-primary hover:bg-primary/10"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=o.forwardRef((e,r)=>{let{className:t,variant:o,size:s,asChild:u=!1,...d}=e,c=u?n.g7:"button";return(0,a.jsx)(c,{className:(0,l.cn)(i({variant:o,size:s,className:t})),ref:r,...d})});u.displayName="Button"},9102:function(e,r,t){"use strict";t.d(r,{Ol:function(){return l},SZ:function(){return u},Zb:function(){return s},aY:function(){return d},eW:function(){return c},ll:function(){return i}});var a=t(9807),o=t(7694),n=t(9456);let s=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...o})});s.displayName="Card";let l=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...o})});l.displayName="CardHeader";let i=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...o})});i.displayName="CardTitle";let u=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...o})});u.displayName="CardDescription";let d=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...o})});d.displayName="CardContent";let c=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...o})});c.displayName="CardFooter"},7459:function(e,r,t){"use strict";t.d(r,{I:function(){return s}});var a=t(9807),o=t(7694),n=t(9456);let s=o.forwardRef((e,r)=>{let{className:t,type:o,...s}=e;return(0,a.jsx)("input",{type:o,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...s})});s.displayName="Input"},2611:function(e,r,t){"use strict";t.d(r,{_:function(){return u}});var a=t(9807),o=t(7694),n=t(8519),s=t(6640),l=t(9456);let i=(0,s.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)(n.f,{ref:r,className:(0,l.cn)(i(),t),...o})});u.displayName=n.f.displayName},4616:function(e,r,t){"use strict";t.d(r,{AuthProvider:function(){return u},a:function(){return d}});var a=t(9807),o=t(7694),n=t(2936),s=t(6976),l=t(5200);let i=(0,o.createContext)(null);function u(e){let{children:r}=e,[t,u]=(0,o.useState)(null),[d,c]=(0,o.useState)(null),[f,m]=(0,o.useState)(!0),[b,p]=(0,o.useState)(null),g=async e=>{try{let r=(0,n.JU)(s.db,"users",e.uid);await (0,n.oe)(r),console.log("Documento do usu\xe1rio deletado com sucesso"),await (0,l.h8)(e),console.log("Usu\xe1rio deletado do Auth com sucesso"),u(null),c(null),p(null)}catch(e){throw console.error("Erro ao limpar usu\xe1rio:",e),e}},h=async(e,r,t)=>{try{console.log("Iniciando cria\xe7\xe3o do documento do usu\xe1rio:",e.uid);let a=(0,n.JU)(s.db,"users",e.uid);if(!(await (0,n.QT)(a)).exists()){console.log("Criando novo documento para o usu\xe1rio");let o={id:e.uid,name:r,email:e.email||"",role:"student",createdAt:(0,n.Bt)(),lastLogin:(0,n.Bt)()};return console.log("Dados do novo usu\xe1rio:",o),await (0,n.pl)(a,o,{merge:!1}),console.log("Documento criado com sucesso"),await (0,n.ET)((0,n.hJ)(s.db,"subscriptions"),{userId:e.uid,type:"MESTRE_AMIGO"===t?"private":"free",status:"active",createdAt:(0,n.Bt)(),updatedAt:(0,n.Bt)(),tokens:{available:0,unlimited:"MESTRE_AMIGO"===t}}),console.log("Assinatura criada com sucesso"),p("student"),c(r),o}return null}catch(e){throw console.error("Erro ao criar documento do usu\xe1rio:",e),e}},v=async e=>{try{let r=await (0,n.QT)((0,n.JU)(s.db,"users",e));if(r.exists()){let e=r.data();return c(e.name),p(e.role),e}return null}catch(e){return console.error("Erro ao buscar dados do usu\xe1rio:",e),null}};return(0,o.useEffect)(()=>{let e=s.I8.onAuthStateChanged(async e=>{console.log("Auth state changed, user:",null==e?void 0:e.uid),u(e),m(!0);try{e?await v(e.uid)||(c(null),p(null)):(c(null),p(null),console.log("User logged out, role set to null"))}catch(e){console.error("Erro ao carregar dados do usu\xe1rio:",e),p(null),c(null)}finally{m(!1)}});return()=>e()},[]),(0,a.jsx)(i.Provider,{value:{user:t,userName:d,loading:f,role:b,createUserDocument:h,cleanupUserOnError:g,fetchUserData:v,updateLastLogin:e=>{let r=(0,n.JU)(s.db,"users",e);(0,n.pl)(r,{lastLogin:(0,n.Bt)()},{merge:!0}).catch(e=>{console.error("Erro ao atualizar lastLogin:",e)})}},children:r})}function d(){let e=(0,o.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},6976:function(e,r,t){"use strict";let a,o,n;t.d(r,{I8:function(){return a},db:function(){return o},tO:function(){return n}});var s=t(3631),l=t(3797),i=t(5200),u=t(2936),d=t(9542);let c={apiKey:"AIzaSyABZJxTb4i_SDIBE-j530FN1cGBwmkB054",authDomain:"mestre-da-redacao.firebaseapp.com",projectId:"mestre-da-redacao",storageBucket:"mestre-da-redacao.firebasestorage.app",messagingSenderId:"326080016742",appId:"1:326080016742:web:239aa8c38ec32dcfe018a7"};console.log("Configura\xe7\xe3o do Firebase:",{...c,apiKey:"***"});let f=(0,s.ZF)(c),m=null;try{console.log("App Firebase inicializado:",f.name),m=(0,l.IH)(f),a=(0,i.v0)(f),o=(0,u.ad)(f),n=(0,d.getStorage)(f),console.log("Servi\xe7os Firebase inicializados:",{auth:!!a,db:!!o,analytics:!!m,storage:!!n})}catch(e){throw console.error("Erro ao inicializar Firebase:",e),e}},9456:function(e,r,t){"use strict";t.d(r,{cn:function(){return n}});var a=t(8223),o=t(6257);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,o.m6)((0,a.W)(r))}},8249:function(e,r,t){"use strict";t.d(r,{default:function(){return o.a}});var a=t(8837),o=t.n(a)},259:function(e,r,t){"use strict";var a=t(2779);t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},8519:function(e,r,t){"use strict";t.d(r,{f:function(){return l}});var a=t(7694),o=t(8892),n=t(9807),s=a.forwardRef((e,r)=>(0,n.jsx)(o.WV.label,{...e,ref:r,onMouseDown:r=>{var t;r.target.closest("button, input, select, textarea")||(null===(t=e.onMouseDown)||void 0===t||t.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));s.displayName="Label";var l=s},8892:function(e,r,t){"use strict";t.d(r,{WV:function(){return l},jH:function(){return i}});var a=t(7694),o=t(2723),n=t(2931),s=t(9807),l=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,r)=>{let t=a.forwardRef((e,t)=>{let{asChild:a,...o}=e,l=a?n.g7:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(l,{...o,ref:t})});return t.displayName=`Primitive.${r}`,{...e,[r]:t}},{});function i(e,r){e&&o.flushSync(()=>e.dispatchEvent(r))}},6640:function(e,r,t){"use strict";t.d(r,{j:function(){return s}});var a=t(8223);let o=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,n=a.W,s=(e,r)=>t=>{var a;if((null==r?void 0:r.variants)==null)return n(e,null==t?void 0:t.class,null==t?void 0:t.className);let{variants:s,defaultVariants:l}=r,i=Object.keys(s).map(e=>{let r=null==t?void 0:t[e],a=null==l?void 0:l[e];if(null===r)return null;let n=o(r)||o(a);return s[e][n]}),u=t&&Object.entries(t).reduce((e,r)=>{let[t,a]=r;return void 0===a||(e[t]=a),e},{});return n(e,i,null==r?void 0:null===(a=r.compoundVariants)||void 0===a?void 0:a.reduce((e,r)=>{let{class:t,className:a,...o}=r;return Object.entries(o).every(e=>{let[r,t]=e;return Array.isArray(t)?t.includes({...l,...u}[r]):({...l,...u})[r]===t})?[...e,t,a]:e},[]),null==t?void 0:t.class,null==t?void 0:t.className)}}},function(e){e.O(0,[5453,291,3727,5624,8837,6830,4315,514,1744],function(){return e(e.s=2938)}),_N_E=e.O()}]);