(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{9852:function(e,t,o){Promise.resolve().then(o.bind(o,9535)),Promise.resolve().then(o.bind(o,4616)),Promise.resolve().then(o.bind(o,6830)),Promise.resolve().then(o.t.bind(o,1456,23))},9535:function(e,t,o){"use strict";o.d(t,{ThemeProvider:function(){return p}});var r=o(9807),n=o(7694),a=(e,t,o,r,n,a,s,l)=>{let i=document.documentElement,u=["light","dark"];function c(t){(Array.isArray(e)?e:[e]).forEach(e=>{let o="class"===e,r=o&&a?n.map(e=>a[e]||e):n;o?(i.classList.remove(...r),i.classList.add(a&&a[t]?a[t]:t)):i.setAttribute(e,t)}),l&&u.includes(t)&&(i.style.colorScheme=t)}if(r)c(r);else try{let e=localStorage.getItem(t)||o,r=s&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;c(r)}catch(e){}},s=["light","dark"],l="(prefers-color-scheme: dark)",i="undefined"==typeof window,u=n.createContext(void 0),c=e=>n.useContext(u)?n.createElement(n.Fragment,null,e.children):n.createElement(m,{...e}),d=["light","dark"],m=e=>{let{forcedTheme:t,disableTransitionOnChange:o=!1,enableSystem:r=!0,enableColorScheme:a=!0,storageKey:i="theme",themes:c=d,defaultTheme:m=r?"system":"light",attribute:p="data-theme",value:b,children:v,nonce:w,scriptProps:E}=e,[S,A]=n.useState(()=>f(i,m)),[T,C]=n.useState(()=>"system"===S?y():S),k=b?Object.values(b):c,I=n.useCallback(e=>{let t=e;if(!t)return;"system"===e&&r&&(t=y());let n=b?b[t]:t,l=o?g(w):null,i=document.documentElement,u=e=>{"class"===e?(i.classList.remove(...k),n&&i.classList.add(n)):e.startsWith("data-")&&(n?i.setAttribute(e,n):i.removeAttribute(e))};if(Array.isArray(p)?p.forEach(u):u(p),a){let e=s.includes(m)?m:null,o=s.includes(t)?t:e;i.style.colorScheme=o}null==l||l()},[w]),L=n.useCallback(e=>{let t="function"==typeof e?e(S):e;A(t);try{localStorage.setItem(i,t)}catch(e){}},[S]),P=n.useCallback(e=>{C(y(e)),"system"===S&&r&&!t&&I("system")},[S,t]);n.useEffect(()=>{let e=window.matchMedia(l);return e.addListener(P),P(e),()=>e.removeListener(P)},[P]),n.useEffect(()=>{let e=e=>{e.key===i&&(e.newValue?A(e.newValue):L(m))};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[L]),n.useEffect(()=>{I(null!=t?t:S)},[t,S]);let _=n.useMemo(()=>({theme:S,setTheme:L,forcedTheme:t,resolvedTheme:"system"===S?T:S,themes:r?[...c,"system"]:c,systemTheme:r?T:void 0}),[S,L,t,T,r,c]);return n.createElement(u.Provider,{value:_},n.createElement(h,{forcedTheme:t,storageKey:i,attribute:p,enableSystem:r,enableColorScheme:a,defaultTheme:m,value:b,themes:c,nonce:w,scriptProps:E}),v)},h=n.memo(e=>{let{forcedTheme:t,storageKey:o,attribute:r,enableSystem:s,enableColorScheme:l,defaultTheme:i,value:u,themes:c,nonce:d,scriptProps:m}=e,h=JSON.stringify([r,o,i,t,c,u,s,l]).slice(1,-1);return n.createElement("script",{...m,suppressHydrationWarning:!0,nonce:"undefined"==typeof window?d:"",dangerouslySetInnerHTML:{__html:"(".concat(a.toString(),")(").concat(h,")")}})}),f=(e,t)=>{let o;if(!i){try{o=localStorage.getItem(e)||void 0}catch(e){}return o||t}},g=e=>{let t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},y=e=>(e||(e=window.matchMedia(l)),e.matches?"dark":"light");function p(e){let{children:t,...o}=e;return(0,r.jsx)(c,{...o,children:t})}},4616:function(e,t,o){"use strict";o.d(t,{AuthProvider:function(){return u},a:function(){return c}});var r=o(9807),n=o(7694),a=o(2936),s=o(6976),l=o(5200);let i=(0,n.createContext)(null);function u(e){let{children:t}=e,[o,u]=(0,n.useState)(null),[c,d]=(0,n.useState)(null),[m,h]=(0,n.useState)(!0),[f,g]=(0,n.useState)(null),y=async e=>{try{let t=(0,a.JU)(s.db,"users",e.uid);await (0,a.oe)(t),console.log("Documento do usu\xe1rio deletado com sucesso"),await (0,l.h8)(e),console.log("Usu\xe1rio deletado do Auth com sucesso"),u(null),d(null),g(null)}catch(e){throw console.error("Erro ao limpar usu\xe1rio:",e),e}},p=async(e,t,o)=>{try{console.log("Iniciando cria\xe7\xe3o do documento do usu\xe1rio:",e.uid);let r=(0,a.JU)(s.db,"users",e.uid);if(!(await (0,a.QT)(r)).exists()){console.log("Criando novo documento para o usu\xe1rio");let n={id:e.uid,name:t,email:e.email||"",role:"student",createdAt:(0,a.Bt)(),lastLogin:(0,a.Bt)()};return console.log("Dados do novo usu\xe1rio:",n),await (0,a.pl)(r,n,{merge:!1}),console.log("Documento criado com sucesso"),await (0,a.ET)((0,a.hJ)(s.db,"subscriptions"),{userId:e.uid,type:"MESTRE_AMIGO"===o?"private":"free",status:"active",createdAt:(0,a.Bt)(),updatedAt:(0,a.Bt)(),tokens:{available:0,unlimited:"MESTRE_AMIGO"===o}}),console.log("Assinatura criada com sucesso"),g("student"),d(t),n}return null}catch(e){throw console.error("Erro ao criar documento do usu\xe1rio:",e),e}},b=async e=>{try{let t=await (0,a.QT)((0,a.JU)(s.db,"users",e));if(t.exists()){let e=t.data();return d(e.name),g(e.role),e}return null}catch(e){return console.error("Erro ao buscar dados do usu\xe1rio:",e),null}};return(0,n.useEffect)(()=>{let e=s.I8.onAuthStateChanged(async e=>{console.log("Auth state changed, user:",null==e?void 0:e.uid),u(e),h(!0);try{e?await b(e.uid)||(d(null),g(null)):(d(null),g(null),console.log("User logged out, role set to null"))}catch(e){console.error("Erro ao carregar dados do usu\xe1rio:",e),g(null),d(null)}finally{h(!1)}});return()=>e()},[]),(0,r.jsx)(i.Provider,{value:{user:o,userName:c,loading:m,role:f,createUserDocument:p,cleanupUserOnError:y,fetchUserData:b,updateLastLogin:e=>{let t=(0,a.JU)(s.db,"users",e);(0,a.pl)(t,{lastLogin:(0,a.Bt)()},{merge:!0}).catch(e=>{console.error("Erro ao atualizar lastLogin:",e)})}},children:t})}function c(){let e=(0,n.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},6976:function(e,t,o){"use strict";let r,n,a;o.d(t,{I8:function(){return r},db:function(){return n},tO:function(){return a}});var s=o(3631),l=o(3797),i=o(5200),u=o(2936),c=o(9542);let d={apiKey:"AIzaSyABZJxTb4i_SDIBE-j530FN1cGBwmkB054",authDomain:"mestre-da-redacao.firebaseapp.com",projectId:"mestre-da-redacao",storageBucket:"mestre-da-redacao.firebasestorage.app",messagingSenderId:"326080016742",appId:"1:326080016742:web:239aa8c38ec32dcfe018a7"};console.log("Configura\xe7\xe3o do Firebase:",{...d,apiKey:"***"});let m=(0,s.ZF)(d),h=null;try{console.log("App Firebase inicializado:",m.name),h=(0,l.IH)(m),r=(0,i.v0)(m),n=(0,u.ad)(m),a=(0,c.getStorage)(m),console.log("Servi\xe7os Firebase inicializados:",{auth:!!r,db:!!n,analytics:!!h,storage:!!a})}catch(e){throw console.error("Erro ao inicializar Firebase:",e),e}},1456:function(){}},function(e){e.O(0,[2755,5453,291,5624,6830,4315,514,1744],function(){return e(e.s=9852)}),_N_E=e.O()}]);