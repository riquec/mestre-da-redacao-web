(()=>{var e={};e.id=827,e.ids=[827],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},66958:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>d,routeModule:()=>m,tree:()=>c}),a(16717),a(95892),a(54821),a(17489);var r=a(88619),t=a(31304),i=a(2332),n=a.n(i),o=a(66734),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);a.d(s,l);let c=["",{children:["dashboard",{children:["assinatura",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,16717)),"/Users/henriquejardim/Documents/dev/mestre-da-redacao/mestre-redacao-web/app/dashboard/assinatura/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,95892)),"/Users/henriquejardim/Documents/dev/mestre-da-redacao/mestre-redacao-web/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,54821)),"/Users/henriquejardim/Documents/dev/mestre-da-redacao/mestre-redacao-web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,17489,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/henriquejardim/Documents/dev/mestre-da-redacao/mestre-redacao-web/app/dashboard/assinatura/page.tsx"],p="/dashboard/assinatura/page",u={require:a,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/dashboard/assinatura/page",pathname:"/dashboard/assinatura",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},78967:(e,s,a)=>{Promise.resolve().then(a.bind(a,70002))},70002:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>f});var r=a(30173),t=a(73317),i=a(12424),n=a(64619),o=a(47393),l=a(73090),c=a(50867),d=a(4249),p=a(20348),u=a(30789),m=a(57699);let x=(0,a(51825).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var h=a(43080),j=a(86675);let v=[{type:"free",name:"Plano B\xe1sico",description:"Para conhecer a plataforma",price:0,tokens:0,features:["Acesso ilimitado \xe0s videoaulas","Acesso \xe0s propostas de reda\xe7\xe3o","Materiais de apoio b\xe1sicos"]},{type:"medium",name:"Plano M\xe9dio",description:"Para praticar regularmente",price:9.9,tokens:2,features:["Tudo do plano b\xe1sico","2 corre\xe7\xf5es de reda\xe7\xe3o por m\xeas","Feedback detalhado por escrito","Acesso a materiais exclusivos"]},{type:"master",name:"Plano Mestre",description:"Para quem busca excel\xeancia",price:19.9,tokens:4,features:["Tudo do plano m\xe9dio","4 corre\xe7\xf5es de reda\xe7\xe3o por m\xeas","Feedback detalhado por escrito","Feedback em \xe1udio do professor","Acesso a materiais premium","Prioridade na corre\xe7\xe3o","Suporte priorit\xe1rio"]},{type:"master_plus",name:"Plano Mestre++",description:"Experi\xeancia completa",price:35.9,tokens:6,features:["Tudo do plano mestre","6 corre\xe7\xf5es de reda\xe7\xe3o por m\xeas","Chat com professor","Mentoria individual mensal","Acesso a corre\xe7\xf5es de outros alunos"]}];function f(){let e=(0,i.useRouter)(),s=(0,i.useSearchParams)(),{user:a}=(0,l.a)(),{toast:f}=(0,p.pm)(),[g,y]=(0,t.useState)(null),[b,N]=(0,t.useState)(!1),[P,w]=(0,t.useState)(null),[k,q]=(0,t.useState)(!0),[A,C]=(0,t.useState)(!1),[Z,S]=(0,t.useState)(null),[M,_]=(0,t.useState)(!1),[z,E]=(0,t.useState)(!1),B=async()=>{if(a&&g){N(!0);try{let r=v.find(e=>e.type===g);if(!r)throw Error("Plano n\xe3o encontrado");await (0,n.ET)((0,n.hJ)(o.db,"subscriptions"),{userId:a.uid,type:r.type,status:"active",createdAt:(0,n.Bt)(),updatedAt:(0,n.Bt)(),tokens:{available:r.tokens,unlimited:!1}}),S(r),C(!0),setTimeout(()=>{let a=s.get("returnTo");a?e.push(a):e.push("/dashboard")},3e3)}catch(e){console.error("Erro ao criar assinatura:",e),f({title:"Erro ao realizar assinatura",description:"Ocorreu um erro ao processar sua assinatura. Por favor, tente novamente mais tarde.",variant:"destructive"})}finally{N(!1)}}},T=async()=>{if(P){E(!0);try{let e=(0,n.JU)(o.db,"subscriptions",P.id);await (0,n.r7)(e,{status:"cancelled",cancelledAt:(0,n.Bt)(),updatedAt:(0,n.Bt)()});let s=(0,n.hJ)(o.db,"essays"),r=(0,n.IO)(s,(0,n.ar)("userId","==",a?.uid),(0,n.ar)("status","==","pending")),t=(await (0,n.PL)(r)).docs.map(async e=>{await (0,n.r7)(e.ref,{status:"cancelled",cancelledAt:(0,n.Bt)(),updatedAt:(0,n.Bt)()})});await Promise.all(t),f({title:"Assinatura cancelada",description:"Sua assinatura foi cancelada com sucesso."}),w(null),_(!1)}catch(e){console.error("Erro ao cancelar assinatura:",e),f({title:"Erro ao cancelar assinatura",description:"Ocorreu um erro ao cancelar sua assinatura. Por favor, tente novamente mais tarde.",variant:"destructive"})}finally{E(!1)}}};if(k)return r.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:r.jsx(u.Z,{className:"h-8 w-8 animate-spin"})});if(P){let e=v.find(e=>e.type===P.type);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Sua Assinatura"}),r.jsx("p",{className:"text-gray-500",children:"Gerencie seu plano atual"})]}),(0,r.jsxs)(d.Zb,{children:[(0,r.jsxs)(d.Ol,{children:[r.jsx(d.ll,{children:e?.name}),r.jsx(d.SZ,{children:e?.description})]}),r.jsx(d.aY,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[r.jsx(m.Z,{className:"h-5 w-5"}),r.jsx("span",{children:"Assinatura ativa"})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Corre\xe7\xf5es dispon\xedveis"}),r.jsx("p",{className:"text-lg font-semibold",children:"partner"===P.type||"private"===P.type?"Corre\xe7\xf5es ilimitadas":`${P.tokens.available} / ${P.tokens.available}`})]})]})}),(0,r.jsxs)(d.eW,{className:"flex gap-4",children:[r.jsx(c.z,{variant:"outline",disabled:!0,children:"Trocar Plano"}),r.jsx(c.z,{variant:"outline",onClick:()=>_(!0),disabled:"partner"===P.type||"private"===P.type,children:"Cancelar Assinatura"})]})]}),r.jsx(j.Vq,{open:M,onOpenChange:_,children:(0,r.jsxs)(j.cZ,{className:"sm:max-w-md",children:[(0,r.jsxs)(j.fK,{children:[(0,r.jsxs)(j.$N,{className:"flex items-center gap-2 text-yellow-600",children:[r.jsx(x,{className:"h-6 w-6"}),"Cancelar Assinatura"]}),r.jsx(j.Be,{children:"Tem certeza que deseja cancelar sua assinatura? Esta a\xe7\xe3o n\xe3o pode ser desfeita."})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-yellow-600",children:[r.jsx(x,{className:"h-5 w-5"}),r.jsx("span",{children:"Suas corre\xe7\xf5es pendentes ser\xe3o canceladas"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-yellow-600",children:[r.jsx(x,{className:"h-5 w-5"}),r.jsx("span",{children:"Voc\xea perder\xe1 acesso aos benef\xedcios do plano"})]})]}),(0,r.jsxs)(j.cN,{className:"flex gap-2",children:[r.jsx(c.z,{variant:"outline",onClick:()=>_(!1),disabled:z,children:"Manter Assinatura"}),r.jsx(c.z,{variant:"destructive",onClick:T,disabled:z,children:z?(0,r.jsxs)(r.Fragment,{children:[r.jsx(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Cancelando..."]}):"Confirmar Cancelamento"})]})]})})]})}return(0,r.jsxs)(r.Fragment,{children:[r.jsx(j.Vq,{open:A,onOpenChange:C,children:(0,r.jsxs)(j.cZ,{className:"sm:max-w-md",children:[(0,r.jsxs)(j.fK,{children:[(0,r.jsxs)(j.$N,{className:"flex items-center gap-2 text-green-600",children:[r.jsx(m.Z,{className:"h-6 w-6"}),"Assinatura realizada com sucesso!"]}),(0,r.jsxs)(j.Be,{children:["Seu plano ",Z?.name," foi ativado com sucesso. Voc\xea ser\xe1 redirecionado para o dashboard em instantes."]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[r.jsx(h.Z,{className:"h-5 w-5"}),(0,r.jsxs)("span",{children:["Plano ativado: ",Z?.name]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[r.jsx(h.Z,{className:"h-5 w-5"}),(0,r.jsxs)("span",{children:[Z?.tokens," corre\xe7\xf5es dispon\xedveis por m\xeas"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[r.jsx(h.Z,{className:"h-5 w-5"}),r.jsx("span",{children:"Suporte priorit\xe1rio ativado"})]})]})]})}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center max-w-3xl mx-auto",children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Escolha seu Plano"}),r.jsx("p",{className:"text-gray-500 mt-2",children:"Invista no seu futuro com a melhor plataforma de corre\xe7\xe3o de reda\xe7\xf5es"})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:v.map(e=>(0,r.jsxs)(d.Zb,{className:`cursor-pointer transition-all relative ${g===e.type?"border-primary ring-2 ring-primary":""} ${"master"===e.type?"border-2 border-primary shadow-lg":""}`,onClick:()=>y(e.type),children:["master"===e.type&&r.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:r.jsx("div",{className:"bg-primary text-white text-xs font-semibold px-3 py-1 rounded-full",children:"Mais Popular"})}),(0,r.jsxs)(d.Ol,{children:[r.jsx(d.ll,{children:e.name}),r.jsx(d.SZ,{children:e.description})]}),(0,r.jsxs)(d.aY,{children:[(0,r.jsxs)("div",{className:"text-3xl font-bold mb-4",children:[0===e.price?"Gr\xe1tis":`R$ ${e.price.toFixed(2)}`,e.price>0&&r.jsx("span",{className:"text-sm font-normal text-gray-500",children:"/m\xeas"})]}),r.jsx("ul",{className:"space-y-2",children:e.features.map((e,s)=>(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-4 w-4 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e]},s))})]}),r.jsx(d.eW,{children:r.jsx(c.z,{className:"w-full",variant:g===e.type?"default":"outline",onClick:s=>{s.stopPropagation(),y(e.type)},children:g===e.type?"Plano Selecionado":"Selecionar Plano"})})]},e.type))}),r.jsx("div",{className:"flex justify-end",children:r.jsx(c.z,{size:"lg",onClick:B,disabled:!g||b,children:b?(0,r.jsxs)(r.Fragment,{children:[r.jsx(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processando..."]}):"Assinar Plano"})})]})]})}},43080:(e,s,a)=>{"use strict";a.d(s,{Z:()=>r});let r=(0,a(51825).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},57699:(e,s,a)=>{"use strict";a.d(s,{Z:()=>r});let r=(0,a(51825).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},30789:(e,s,a)=>{"use strict";a.d(s,{Z:()=>r});let r=(0,a(51825).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},16717:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>r});let r=(0,a(71268).createProxy)(String.raw`/Users/henriquejardim/Documents/dev/mestre-da-redacao/mestre-redacao-web/app/dashboard/assinatura/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),r=s.X(0,[983,754,636,222,118,142],()=>a(66958));module.exports=r})();