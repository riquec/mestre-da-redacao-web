(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5698],{3728:function(e,r,t){Promise.resolve().then(t.bind(t,3052))},3052:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return k}});var a=t(9807),s=t(7694),o=t(8355),n=t(9102),i=t(2582),l=t(7539),d=t(7459),c=t(2611),u=t(7380),m=t(9456);let f=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsxs)(u.fC,{ref:r,className:(0,m.cn)("relative flex w-full touch-none select-none items-center",t),...s,children:[(0,a.jsx)(u.fQ,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,a.jsx)(u.e6,{className:"absolute h-full bg-primary"})}),(0,a.jsx)(u.bU,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});f.displayName=u.fC.displayName;var x=t(1961),g=t(4596),p=t(8139),v=t(2825),h=t(4414),b=t(6976),j=t(2936),N=t(4616),y=t(9542),w=t(259),C=t(6830);function k(){var e,r,u,m,k,A;let{user:S}=(0,N.a)();(0,w.useRouter)();let[P,D]=(0,s.useState)(null),[I,U]=(0,s.useState)(""),[F,R]=(0,s.useState)([]),[E,T]=(0,s.useState)({}),[L,z]=(0,s.useState)(!0),[B,O]=(0,s.useState)({score:0,competencies:[{name:"Dom\xednio da norma culta",score:0,maxScore:200},{name:"Compreens\xe3o da proposta",score:0,maxScore:200},{name:"Sele\xe7\xe3o de argumentos",score:0,maxScore:200},{name:"Coes\xe3o textual",score:0,maxScore:200},{name:"Proposta de interven\xe7\xe3o",score:0,maxScore:200}],feedback:"",audioFeedback:null,pdfCorrection:null,audioPreview:null,pdfPreview:null,markedImage:null});(0,s.useRef)(null),(0,s.useRef)(null);let[_,Z]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{if(S)try{let e=(0,j.hJ)(b.db,"essays"),r=(0,j.IO)(e,(0,j.ar)("correction.assignedTo","==",S.uid)),t=await (0,j.PL)(r);console.log("Total de reda\xe7\xf5es encontradas:",t.size);let a=await Promise.all(t.docs.map(async e=>{let r=e.data();console.log("Dados da reda\xe7\xe3o:",{id:e.id,files:r.files,userId:r.userId});let t=(0,j.JU)(b.db,"users",r.userId),a=(await (0,j.QT)(t)).data();return{...r,id:e.id,userName:(null==a?void 0:a.name)||"Usu\xe1rio n\xe3o encontrado",userEmail:(null==a?void 0:a.email)||"",fileUrl:r.fileUrl,fileName:r.fileName}}));a.sort((e,r)=>{var t,a;let s=(null===(t=e.submittedAt)||void 0===t?void 0:t.toDate())||new Date(0);return((null===(a=r.submittedAt)||void 0===a?void 0:a.toDate())||new Date(0)).getTime()-s.getTime()}),R(a),console.log("Reda\xe7\xf5es carregadas:",a);let s=[...new Set(a.map(e=>e.themeId))],o={};for(let e of s){let r=(0,j.JU)(b.db,"essayThemes",e),t=await (0,j.QT)(r);t.exists()&&(o[e]={id:t.id,...t.data()})}T(o)}catch(e){console.error("Erro ao buscar reda\xe7\xf5es:",e)}finally{z(!1)}})()},[S]);let J=F.filter(e=>{var r,t,a;return(null===(r=e.userName)||void 0===r?void 0:r.toLowerCase().includes(I.toLowerCase()))||((null===(a=E[e.themeId])||void 0===a?void 0:null===(t=a.title)||void 0===t?void 0:t.toLowerCase())||"").includes(I.toLowerCase())}),V=J.filter(e=>e.correction&&"string"==typeof e.correction.status&&"pending"===e.correction.status||!e.correction||"string"!=typeof e.correction.status),Q=J.filter(e=>e.correction&&"string"==typeof e.correction.status&&"done"===e.correction.status),q=e=>{D(e);let r=F.find(r=>r.id===e);if(null==r?void 0:r.correction){var t;O({...B,score:(null===(t=r.correction.score)||void 0===t?void 0:t.total)||0,feedback:r.correction.feedback||""})}},M=(e,r)=>{let t=[...B.competencies];t[e].score=r[0];let a=t.reduce((e,r)=>e+r.score,0);O({...B,competencies:t,score:a})},Y=async()=>{if(!P||!S)return;Z(!0);let e,r,a="",s="";try{var o,n;B.audioFeedback&&(e=(0,y.ref)(b.tO,"corrections/".concat(P,"/audio-feedback")),await (0,y.uploadBytes)(e,B.audioFeedback),a=await (0,y.getDownloadURL)(e)),B.pdfCorrection&&(r=(0,y.ref)(b.tO,"corrections/".concat(P,"/correction-pdf")),await (0,y.uploadBytes)(r,B.pdfCorrection),s=await (0,y.getDownloadURL)(r));let t=(0,j.JU)(b.db,"essays",P),i={total:B.competencies.reduce((e,r)=>e+r.score,0),dominioNormaCulta:B.competencies[0].score,compreensaoProposta:B.competencies[1].score,selecaoArgumentos:B.competencies[2].score,coesaoTextual:B.competencies[3].score,propostaIntervencao:B.competencies[4].score};await (0,j.r7)(t,{correction:{...(null===(o=F.find(e=>e.id===P))||void 0===o?void 0:o.correction)||{},audioFileUrl:a,correctionFileUrl:s,correctionFileName:null===(n=B.pdfCorrection)||void 0===n?void 0:n.name,completedAt:new Date,score:i,status:"done"}});let l=(0,j.hJ)(b.db,"essays"),d=(0,j.IO)(l,(0,j.ar)("correction.assignedTo","==",S.uid)),c=await (0,j.PL)(d),u=await Promise.all(c.docs.map(async e=>{let r=e.data(),t=(0,j.JU)(b.db,"users",r.userId),a=(await (0,j.QT)(t)).data();return{...r,id:e.id,userName:(null==a?void 0:a.name)||"Usu\xe1rio n\xe3o encontrado",userEmail:(null==a?void 0:a.email)||"",fileUrl:r.fileUrl,fileName:r.fileName}}));u.sort((e,r)=>{var t,a;let s=(null===(t=e.submittedAt)||void 0===t?void 0:t.toDate())||new Date(0);return((null===(a=r.submittedAt)||void 0===a?void 0:a.toDate())||new Date(0)).getTime()-s.getTime()}),R(u),C.A.success("Corre\xe7\xe3o enviada com sucesso!"),D(null)}catch(a){e&&await e&&(await Promise.resolve().then(t.bind(t,9542))).deleteObject(e),r&&await r&&(await Promise.resolve().then(t.bind(t,9542))).deleteObject(r),C.A.error("Erro ao enviar corre\xe7\xe3o. Tente novamente.")}finally{Z(!1)}},G=e=>e>=900?"bg-green-50 text-green-700 border-green-200":e>=700?"bg-blue-50 text-blue-700 border-blue-200":e>=500?"bg-yellow-50 text-yellow-700 border-yellow-200":"bg-red-50 text-red-700 border-red-200";return L?(0,a.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Carregando corre\xe7\xf5es..."})]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Corre\xe7\xf5es"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Gerencie as corre\xe7\xf5es de reda\xe7\xf5es dos alunos"})]}),P?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(o.z,{variant:"outline",onClick:()=>{D(null)},children:"Voltar para lista"}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{children:[(0,a.jsx)(n.ll,{children:"Corrigir reda\xe7\xe3o"}),(0,a.jsx)(n.SZ,{children:(null===(e=E[(null===(r=F.find(e=>e.id===P))||void 0===r?void 0:r.themeId)||""])||void 0===e?void 0:e.title)||"Tema n\xe3o encontrado"})]}),(0,a.jsxs)(n.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("h3",{className:"font-medium",children:"Informa\xe7\xf5es da reda\xe7\xe3o"})}),(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-md",children:(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Aluno:"}),(0,a.jsx)("span",{className:"font-medium",children:null===(u=F.find(e=>e.id===P))||void 0===u?void 0:u.userName})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Proposta:"}),(0,a.jsx)("span",{className:"font-medium",children:(null===(m=E[(null===(k=F.find(e=>e.id===P))||void 0===k?void 0:k.themeId)||""])||void 0===m?void 0:m.title)||"Tema n\xe3o encontrado"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Enviada:"}),(0,a.jsx)("span",{className:"font-medium",children:null===(A=F.find(e=>e.id===P))||void 0===A?void 0:A.submittedAt.toDate().toLocaleDateString()})]})]})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Reda\xe7\xe3o do aluno"}),(0,a.jsx)("div",{className:"border rounded-md overflow-hidden p-4 flex flex-col gap-2 items-start",children:P&&(()=>{let e=F.find(e=>e.id===P);if(!e)return null;let r=e.fileUrl,t=e.fileName||"redacao-aluno",s=e=>{let r=e.match(/\.([a-zA-Z0-9]+)(\?|$)/);return r?r[1].toLowerCase():""},o=s(t)||s(r||""),n="pdf"===o,i=["jpg","jpeg","png","gif","bmp","webp"].includes(o);return r?(0,a.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("a",{href:r,download:t,className:"px-3 py-1 bg-blue-100 text-blue-800 rounded hover:bg-blue-200 text-sm font-medium",target:"_blank",rel:"noopener noreferrer",children:"Baixar arquivo"}),(0,a.jsx)("span",{className:"text-gray-500 text-xs",children:t})]}),n&&(0,a.jsx)("iframe",{src:r,className:"w-full h-64 border rounded-md mt-2",title:"Pr\xe9-visualiza\xe7\xe3o do PDF da reda\xe7\xe3o"}),i&&(0,a.jsx)("img",{src:r,alt:"Reda\xe7\xe3o",className:"max-w-full max-h-96 border rounded-md mt-2"})]}):(0,a.jsx)("div",{children:"Nenhum arquivo dispon\xedvel"})})()})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Upload do PDF da corre\xe7\xe3o"}),(0,a.jsxs)("div",{className:"border-2 border-dashed rounded-md p-6 flex flex-col items-center justify-center text-center",children:[(0,a.jsx)(v.Z,{className:"h-8 w-8 text-gray-400 mb-2"}),(0,a.jsx)("p",{className:"text-sm font-medium mb-1",children:"Arraste e solte o PDF da corre\xe7\xe3o ou clique para selecionar"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-4",children:"Formato aceito: PDF (m\xe1x. 5MB)"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(d.I,{id:"pdf-correction",type:"file",accept:".pdf",onChange:e=>{if(console.log("PDF input onChange disparado"),e.target.files&&e.target.files[0]){let r=e.target.files[0];console.log("Arquivo PDF selecionado:",r),O({...B,pdfCorrection:r,pdfPreview:URL.createObjectURL(r)})}}}),B.pdfCorrection&&(0,a.jsx)("span",{className:"text-sm text-gray-500",children:B.pdfCorrection.name})]}),B.pdfPreview&&(0,a.jsx)("iframe",{src:B.pdfPreview,className:"w-full h-64 border rounded-md mt-4",title:"Pr\xe9-visualiza\xe7\xe3o do PDF"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Avalia\xe7\xe3o por compet\xeancia"}),(0,a.jsx)("div",{className:"space-y-6",children:B.competencies.map((e,r)=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(c._,{children:e.name}),(0,a.jsxs)("span",{className:"font-medium",children:[e.score,"/",e.maxScore]})]}),(0,a.jsx)(f,{value:[e.score],max:e.maxScore,step:10,onValueChange:e=>M(r,e)})]},r))})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Nota final"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:B.score})]}),(0,a.jsx)("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full ".concat(B.score>=900?"bg-green-500":B.score>=700?"bg-blue-500":B.score>=500?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(B.score/1e3*100,"%")}})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Feedback em \xe1udio"}),(0,a.jsxs)("div",{className:"border-2 border-dashed rounded-md p-6 flex flex-col items-center justify-center text-center",children:[(0,a.jsx)(h.Z,{className:"h-8 w-8 text-gray-400 mb-2"}),(0,a.jsx)("p",{className:"text-sm font-medium mb-1",children:"Arraste e solte o arquivo de \xe1udio ou clique para selecionar"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-4",children:"Formatos aceitos: MP3, WAV (m\xe1x. 10MB)"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(d.I,{id:"audio-feedback",type:"file",accept:".mp3,.wav",onChange:e=>{if(console.log("\xc1udio input onChange disparado"),e.target.files&&e.target.files[0]){let r=e.target.files[0];console.log("Arquivo de \xe1udio selecionado:",r),O({...B,audioFeedback:r,audioPreview:URL.createObjectURL(r)})}}}),B.audioFeedback&&(0,a.jsx)("span",{className:"text-sm text-gray-500",children:B.audioFeedback.name})]}),B.audioPreview&&(0,a.jsxs)("audio",{controls:!0,className:"w-full mt-4",children:[(0,a.jsx)("source",{src:B.audioPreview,type:"audio/mpeg"}),"Seu navegador n\xe3o suporta o elemento de \xe1udio."]})]})]})]}),(0,a.jsx)(n.eW,{className:"flex justify-end",children:(0,a.jsx)(o.z,{onClick:Y,disabled:_||!B.audioFeedback||!B.pdfCorrection,children:_?"Enviando...":"Enviar corre\xe7\xe3o"})})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(x.Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),(0,a.jsx)(d.I,{placeholder:"Buscar por aluno ou t\xedtulo...",className:"pl-8",value:I,onChange:e=>U(e.target.value)})]})}),(0,a.jsxs)(i.mQ,{defaultValue:"pending",children:[(0,a.jsxs)(i.dr,{className:"mb-4",children:[(0,a.jsxs)(i.SP,{value:"pending",children:["Pendentes (",V.length,")"]}),(0,a.jsxs)(i.SP,{value:"completed",children:["Conclu\xeddas (",Q.length,")"]})]}),(0,a.jsx)(i.nU,{value:"pending",children:(0,a.jsxs)("div",{className:"grid gap-4",children:[V.map(e=>{var r;return(0,a.jsx)(n.Zb,{children:(0,a.jsx)(n.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"bg-yellow-100 rounded-md p-2",children:(0,a.jsx)(g.Z,{className:"h-5 w-5 text-yellow-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium",children:(null===(r=E[e.themeId])||void 0===r?void 0:r.title)||"Tema n\xe3o encontrado"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Aluno: ",e.userName," • Enviada ",e.submittedAt.toDate().toLocaleDateString()]})]})]}),(0,a.jsx)(o.z,{onClick:()=>q(e.id),children:"Corrigir"})]})})},e.id)}),0===V.length&&(0,a.jsx)("div",{className:"text-center py-10 text-gray-500",children:(0,a.jsx)("p",{children:"Nenhuma corre\xe7\xe3o pendente encontrada"})})]})}),(0,a.jsx)(i.nU,{value:"completed",children:(0,a.jsxs)("div",{className:"grid gap-4",children:[Q.map(e=>{var r,t,s;return(0,a.jsx)(n.Zb,{children:(0,a.jsx)(n.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"bg-green-100 rounded-md p-2",children:(0,a.jsx)(p.Z,{className:"h-5 w-5 text-green-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium",children:(null===(r=E[e.themeId])||void 0===r?void 0:r.title)||"Tema n\xe3o encontrado"}),(0,a.jsxs)(l.C,{variant:"outline",className:G(e.correction&&(null===(t=e.correction.score)||void 0===t?void 0:t.total)||0),children:["Nota: ",e.correction&&e.correction.score&&e.correction.score.total]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Aluno: ",e.userName," • Corrigida ",null===(s=e.correctedAt)||void 0===s?void 0:s.toDate().toLocaleDateString()]})]})]}),(0,a.jsx)(o.z,{variant:"outline",onClick:()=>q(e.id),disabled:!0,children:"Ver detalhes"})]})})},e.id)}),0===Q.length&&(0,a.jsx)("div",{className:"text-center py-10 text-gray-500",children:(0,a.jsx)("p",{children:"Nenhuma corre\xe7\xe3o conclu\xedda encontrada"})})]})})]})]})]})}},7539:function(e,r,t){"use strict";t.d(r,{C:function(){return i}});var a=t(9807);t(7694);var s=t(6640),o=t(9456);let n=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:r,variant:t,...s}=e;return(0,a.jsx)("div",{className:(0,o.cn)(n({variant:t}),r),...s})}},8355:function(e,r,t){"use strict";t.d(r,{d:function(){return l},z:function(){return d}});var a=t(9807),s=t(7694),o=t(2931),n=t(6640),i=t(9456);let l=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",terciary:"bg-background border border-primary text-primary hover:bg-primary/10"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,r)=>{let{className:t,variant:s,size:n,asChild:d=!1,...c}=e,u=d?o.g7:"button";return(0,a.jsx)(u,{className:(0,i.cn)(l({variant:s,size:n,className:t})),ref:r,...c})});d.displayName="Button"},9102:function(e,r,t){"use strict";t.d(r,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return n},aY:function(){return c},eW:function(){return u},ll:function(){return l}});var a=t(9807),s=t(7694),o=t(9456);let n=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});n.displayName="Card";let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",t),...s})});i.displayName="CardHeader";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});l.displayName="CardTitle";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("text-sm text-muted-foreground",t),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("p-6 pt-0",t),...s})});c.displayName="CardContent";let u=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("flex items-center p-6 pt-0",t),...s})});u.displayName="CardFooter"},7459:function(e,r,t){"use strict";t.d(r,{I:function(){return n}});var a=t(9807),s=t(7694),o=t(9456);let n=s.forwardRef((e,r)=>{let{className:t,type:s,...n}=e;return(0,a.jsx)("input",{type:s,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n})});n.displayName="Input"},2611:function(e,r,t){"use strict";t.d(r,{_:function(){return d}});var a=t(9807),s=t(7694),o=t(8519),n=t(6640),i=t(9456);let l=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(o.f,{ref:r,className:(0,i.cn)(l(),t),...s})});d.displayName=o.f.displayName},2582:function(e,r,t){"use strict";t.d(r,{SP:function(){return d},dr:function(){return l},mQ:function(){return i},nU:function(){return c}});var a=t(9807),s=t(7694),o=t(2815),n=t(9456);let i=o.fC,l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(o.aV,{ref:r,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...s})});l.displayName=o.aV.displayName;let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(o.xz,{ref:r,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...s})});d.displayName=o.xz.displayName;let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(o.VY,{ref:r,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s})});c.displayName=o.VY.displayName},4616:function(e,r,t){"use strict";t.d(r,{AuthProvider:function(){return d},a:function(){return c}});var a=t(9807),s=t(7694),o=t(2936),n=t(6976),i=t(5200);let l=(0,s.createContext)(null);function d(e){let{children:r}=e,[t,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(null),[m,f]=(0,s.useState)(!0),[x,g]=(0,s.useState)(null),p=async e=>{try{let r=(0,o.JU)(n.db,"users",e.uid);await (0,o.oe)(r),console.log("Documento do usu\xe1rio deletado com sucesso"),await (0,i.h8)(e),console.log("Usu\xe1rio deletado do Auth com sucesso"),d(null),u(null),g(null)}catch(e){throw console.error("Erro ao limpar usu\xe1rio:",e),e}},v=async(e,r,t)=>{try{console.log("Iniciando cria\xe7\xe3o do documento do usu\xe1rio:",e.uid);let a=(0,o.JU)(n.db,"users",e.uid);if(!(await (0,o.QT)(a)).exists()){console.log("Criando novo documento para o usu\xe1rio");let s={id:e.uid,name:r,email:e.email||"",role:"student",createdAt:(0,o.Bt)(),lastLogin:(0,o.Bt)()};return console.log("Dados do novo usu\xe1rio:",s),await (0,o.pl)(a,s,{merge:!1}),console.log("Documento criado com sucesso"),await (0,o.ET)((0,o.hJ)(n.db,"subscriptions"),{userId:e.uid,type:"MESTRE_AMIGO"===t?"private":"free",status:"active",createdAt:(0,o.Bt)(),updatedAt:(0,o.Bt)(),tokens:{available:0,unlimited:"MESTRE_AMIGO"===t}}),console.log("Assinatura criada com sucesso"),g("student"),u(r),s}return null}catch(e){throw console.error("Erro ao criar documento do usu\xe1rio:",e),e}},h=async e=>{try{let r=await (0,o.QT)((0,o.JU)(n.db,"users",e));if(r.exists()){let e=r.data();return u(e.name),g(e.role),e}return null}catch(e){return console.error("Erro ao buscar dados do usu\xe1rio:",e),null}};return(0,s.useEffect)(()=>{let e=n.I8.onAuthStateChanged(async e=>{console.log("Auth state changed, user:",null==e?void 0:e.uid),d(e),f(!0);try{e?await h(e.uid)||(u(null),g(null)):(u(null),g(null),console.log("User logged out, role set to null"))}catch(e){console.error("Erro ao carregar dados do usu\xe1rio:",e),g(null),u(null)}finally{f(!1)}});return()=>e()},[]),(0,a.jsx)(l.Provider,{value:{user:t,userName:c,loading:m,role:x,createUserDocument:v,cleanupUserOnError:p,fetchUserData:h,updateLastLogin:e=>{let r=(0,o.JU)(n.db,"users",e);(0,o.pl)(r,{lastLogin:(0,o.Bt)()},{merge:!0}).catch(e=>{console.error("Erro ao atualizar lastLogin:",e)})}},children:r})}function c(){let e=(0,s.useContext)(l);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},6976:function(e,r,t){"use strict";let a,s,o;t.d(r,{I8:function(){return a},db:function(){return s},tO:function(){return o}});var n=t(3631),i=t(3797),l=t(5200),d=t(2936),c=t(9542);let u={apiKey:"AIzaSyABZJxTb4i_SDIBE-j530FN1cGBwmkB054",authDomain:"mestre-da-redacao.firebaseapp.com",projectId:"mestre-da-redacao",storageBucket:"mestre-da-redacao.firebasestorage.app",messagingSenderId:"326080016742",appId:"1:326080016742:web:239aa8c38ec32dcfe018a7"};console.log("Configura\xe7\xe3o do Firebase:",{...u,apiKey:"***"});let m=(0,n.ZF)(u),f=null;try{console.log("App Firebase inicializado:",m.name),f=(0,i.IH)(m),a=(0,l.v0)(m),s=(0,d.ad)(m),o=(0,c.getStorage)(m),console.log("Servi\xe7os Firebase inicializados:",{auth:!!a,db:!!s,analytics:!!f,storage:!!o})}catch(e){throw console.error("Erro ao inicializar Firebase:",e),e}},9456:function(e,r,t){"use strict";t.d(r,{cn:function(){return o}});var a=t(8223),s=t(6257);function o(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.m6)((0,a.W)(r))}}},function(e){e.O(0,[5453,291,3727,5624,1013,6830,8600,9228,4315,514,1744],function(){return e(e.s=3728)}),_N_E=e.O()}]);